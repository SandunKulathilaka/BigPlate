(this.$WP=this.$WP||[]).push(["bn3xjr",(e,r)=>{var t,i,a,o,n,s,l,d,c,p,h,u,v,m,f,_,b,y,g,C,N,P,T,w,z,I,k,x,S,A,L,q,R,B,U,W,M,E={__key:0xb7b8df647ce5,id:"b7b8df647ce5c473",loc:{},definitions:[]},j={header:"eUuvl Px MK",strong:"GapOu"},H={READ:()=>t(y,{id:"trips_share_read_only",args:{className:j.strong}}),WRITE:()=>t(y,{id:"trips_share_read_write",args:{className:j.strong}}),PUBLIC:()=>t(y,{id:"trips_share_read_only",args:{className:j.strong}})};function O({shareUrl:e,shareType:r,trip:o,repostProps:n}){var s=H[r](),l="WRITE"===r?"WriteTrip":"ReadTrip";return o.actionPermissions?.canEdit||(s=null,l="NotMyTrip"),e?i(a,{children:[s&&t("div",{className:j.header,children:t(A,{variant:"supporting-01",children:s})}),t(x,{url:e,itemType:l,itemId:`${o.id}`,repostProps:n})]}):t(L,{size:"small"})}function F({trip:e,shareType:r,alignEdge:o="left",shiftArrow:n=0,closeOnScroll:d=!1,repostProps:c,children:p}){var[h,v]=s(()=>{var t=e.route?.url||B({tripId:e.id});return{href:"PUBLIC"===r?t:"",type:r}}),[,m]=u(E),f=l(()=>{"PUBLIC"===r?v({href:B({tripId:e.id}),type:"PUBLIC"}):m({tripId:e.id,type:r}).then(e=>{v({href:e?.data?.createTripToken?.route?.url??"",type:r})})},[m,r,e.id]),_=l(e=>{h.href&&h.type===r||f(),e()},[r,h.href,h.type,f]);return t(S,{local:!0,closeButton:!1,below:!0,alignEdge:o,arrowType:"small",shiftArrow:n,contents:()=>t(O,{shareUrl:h.href,shareType:r,trip:e,repostProps:c}),children:(e,r,o)=>i(a,{children:[d&&t(q,{callback:o,throttle:500}),p(e,()=>_(r),h.type,o)]})})}function Q({trip:e,shareType:r,alignEdge:i,onClick:a,repostProps:o}){return t(F,{trip:e,shareType:r,alignEdge:i,repostProps:o,children:(r,i,o)=>t(I,{itemType:"Trip",itemId:`${e.id}`,url:o,action:"share_button_click",children:()=>t(R,{children:e=>t(k,{onClick:r=>{a&&a(),e(r,"share"),i()},target:r,styleAsSocialAction:!0})})})})}var $={collabWrap:"BXvZB e w",collabList:"Zxroa _g",collabHeader:"F0",collabItem:"qYBPw u Pe PN Pr PA",displayName:"CRLrW S4 H3 b",context:"uAdRx S4 H3",owner:"QECcM",addFriendsText:"yTdVZ S4 H3 b _S",removeButton:"sHhQr Wc _S"},Z={__key:0x6a0e8742e536,id:"6a0e8742e536b909",loc:{},definitions:[]};function D(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Y=({user:e,contextNode:r,avatarNotLazy:a})=>{var o=`/Profile/${e.username}`,n=t(_,{notLazy:a,size:"medium",source:e.avatar?.photoSizes,container:e=>t(w,{href:o,mobileTarget:"_self",children:e})});return i("div",{className:$.collabItem,children:[n,t("a",{href:o,className:f($.displayName,"ui_link"),children:e.displayName}),r&&t("div",{className:$.context,children:r})]})},G=({trip:e,onClick:r})=>{var{localize:a}=g();return t(F,{shiftArrow:7,trip:e,shareType:"WRITE",children:(e,o)=>{var n=()=>{o(),r&&r()};return i("div",{className:f($.collabItem,$.collabHeader),children:[t(W,{onClick:n,ref:e}),t(z,{onClick:n,children:t("span",{className:$.addFriendsText,children:a("trips_add_CTA")})})]})}})},K=e=>{var{localize:r}=g(),{isWebview:i}=h(),a=p();return t(U,{...e,localize:r,loggedInUserId:a,isNativeWebview:i})};return e({ShareTripPopup:F,ShareTripPopupAction:Q}),[()=>{W=n(function({onClick:e},r){return t(d,{variant:"primary",icon:c,onClick:e,"aria-label":"",ref:r})}),U=class extends o.PureComponent{renderPanel(e){var{props:r}=this,{collaborators:a}=r.trip,o=t("div",{className:$.owner,children:this.props.localize("trips_owner")}),n=r.trip.actionPermissions;return i("div",{className:$.collabWrap,children:[n?.canAddCollaborators&&!r.readOnly&&t(G,{trip:r.trip,onClick:r.onAddCollaboratorClick}),i("div",{className:$.collabList,children:[r.trip.owner&&t(Y,{user:r.trip.owner,contextNode:o,avatarNotLazy:r.avatarNotLazy}),a&&a.map(i=>i.user&&t(Y,{user:i.user,avatarNotLazy:r.avatarNotLazy,contextNode:!r.readOnly&&this.getContextNode(i,e)},i.userId))]})]})}render(){return t(T,{children:({navigate:e})=>t(C,{children:r=>t(v,{query:Z,children:({executeMutation:i})=>this.renderPanel(a=>{this.props.onRemove&&this.props.onRemove(a),void 0!==a.id&&i({collaboratorId:a.id}).then(()=>{if(this.props.refetchQueries)return Promise.all(this.props.refetchQueries.map(({query:e,variables:r})=>this.context.query(e,r??{},{requestPolicy:"network-only"})))}).then(()=>{var i=a.user&&a.user.isMe;if("PUBLIC"!==this.props.trip.status&&i){e({page:"Trips"});return}var o=a.user&&a.user.displayName||this.props.localize.string("trips_unknown_user");r({node:t(N,{children:this.props.localize("trips_collaborator_removed_confirm",{UserName:o})})})})})})})})}constructor(...e){super(...e),D(this,"getContextNode",(e,r)=>{var t=e.actionPermissions;return t?.canRemove?this.renderConfirmationAndContent(e,r):null}),D(this,"renderConfirmationAndContent",(e,r)=>{var i,a,o,{user:n}=e;n?.isMe?(i=this.props.localize.string("trips_leave_trip_modal_header"),a=this.props.localize.string("trips_leave_trip_modal_body"),o=this.props.localize.string("trips_leave_CTA")):(i=this.props.localize.string("trips_remove_collaborator_modal_header"),a=this.props.localize.string("trips_remove_collaborator_modal_body"),o=this.props.localize.string("trips_remove_CTA"));var s=o,l=this.props.localize.string("stat_modal_cancel"),d=()=>r(e),c=null;return this.props.isNativeWebview&&(c=()=>P.showNativeOverflowMenu({treatment:"alert",title:i,subtitle:a,items:[{title:l,tapCallback:()=>{}},{preferred:!0,title:s,destructive:!0,tapCallback:d}]})),t(b,{header:i,description:a,cancel:l,confirm:s,above:!0,alignEdge:"right",shiftY:30,onConfirm:d,onCancel:null,children:(r,i)=>t(z,{ref:r,onClick:()=>{(c||i)(),this.props.onRemoveShow&&this.props.onRemoveShow(e)},children:t("span",{className:$.removeButton,children:o})})})})}},D(U,"contextType",m),D(U,"defaultProps",{isNativeWebview:!1,refetchQueries:[],readOnly:!1,onRemoveShow:void 0,onRemove:void 0,avatarNotLazy:!1}),M=K,e({AddFriendIcon:W,CollaboratorPanel:M,ShareTripPopup:F,ShareTripPopupAction:Q})},[e=>(t=e.jsx,i=e.jsxs,a=e.Fragment),e=>(o=e,n=e.forwardRef,s=e.useState,l=e.useCallback),e=>d=e.CircularButton,e=>c=e.default,e=>p=e.useUserId,e=>h=e.useUserAgent,e=>(u=e.useMutation,v=e.Mutation,m=e.Context),e=>f=e.default,e=>_=e.Avatar,e=>b=e.ConfirmationPopover,e=>(y=e.UnsafeLocalize,g=e.useLocalize),e=>(C=e.ToastConsumer,N=e.ToastItem),e=>P=e.NativeBridge,e=>(T=e.RouteConsumer,w=e.ResponsiveTargetLink),e=>z=e.default,e=>(I=e.ShareTracker,k=e.ShareTarget,x=e.ShareDropdownMenu),e=>S=e.default,e=>A=e.default,e=>L=e.LoadingSpinner,e=>q=e.default,e=>R=e.InteractionLogger,e=>B=e.buildPublicTripShareUrl]]},["21h32l","o4yt4q","jppfwt","2wld0u","52far5","nnprhg","mqwhqn","fkji80","ljqkwp","q97pgh","7thqz4","tr3542","0of6qq","bvvaww","6g4avl","7j6z14","4q9l40","essqvy","l9qeu7","w1vb4i","yc8qq2","iyqcwg"]]);
