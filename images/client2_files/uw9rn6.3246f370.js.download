(this.$WP=this.$WP||[]).push(["uw9rn6",(e,r)=>{var t,i,a,p,s,d,n,o,T,u,c,l,I,m,y,v,f,g=({object:e,sourceTripId:r,tripItemId:t,additionalItemReferences:p})=>{var T=c(),[,u]=l(s),[,m]=l(d),[,y]=l(n),[v,f]=i({fetching:!1}),g=Number(e?.id),_=e?.type==="gaiTrip",h=e?.type==="publicTripBundle",P=a(()=>t?"COPY_TRIP_ITEM":_?"COPY_TRIP":"ADD_ITEM_TO_TRIP",[_,t]);if(!e)return[v,()=>Promise.resolve([null,null])];var E=(r,t,i)=>{r?t?f({fetching:!1,result:{trip:r,tripItem:t}}):["bundleSave","gaiTrip","publicTripBundle"].includes(e.type)?f({fetching:!1,result:{trip:r,tripItem:{__typename:"TripItem",id:0,comments:[],reference:{id:e.id.toString(),type:e.type}}}}):f({fetching:!1,error:{query:P,tripsError:i??void 0}}):f({fetching:!1,error:{query:P,tripsError:i??void 0}})};return[v,async i=>{f({fetching:!0});try{if(t&&r&&!isNaN(r)){var a,s,d,n=await y({copyComments:!1,sourceTripId:r,targetTripId:i,copyStructure:!1,sourceItemIds:[t]});n?.data?.Trips_copyTripItem?.itemIds?.[0]&&(s={__typename:"TripItem",id:n.data.Trips_copyTripItem.itemIds[0],comments:[],reference:{id:e.id.toString(),type:e.type}});var c=await T.query(o,{tripId:i}).toPromise();a=c?.data?.tripsGetOne,d=n?.data?.Trips_copyTripItem?.errors?.[0]}else if(_||h){if(!isNaN(g)){var l=await m({copyComments:!1,tripId:g,targetTripId:i,excludeItemTypes:["Note"],additionalItemReferences:p});a={id:l?.data?.Trips_copyTrip?.tripId??0,__typename:"Trip"},d=l?.data?.Trips_copyTrip?.errors?.[0]}}else{var v=await u({tripId:i,referenceId:`${e.id}`,referenceType:e.type,allowDuplicates:!1});a=v?.data?.addItemToTrip?.trip,d=v?.data?.addItemToTrip?.errors?.[0]?.error,a&&(s=I(a,e))}return E(a,s,d),[a,d]}catch(e){return console.error(e),f({fetching:!1,error:{query:P}}),[null,null]}}]},_="mostRecentlyAddedToTrip",h=(e,r)=>{r?m.set(_,{tripId:e,userId:r},144e5):m.remove(_)},P=e=>{var r=m.get(_);return r&&r.userId===e?r.tripId:null},E=({selectedTripId:e,object:r,isActive:t,onExplicitSave:i,tripItemId:a,sourceTripId:s})=>{var[d,n]=v({object:r,tripItemId:a,sourceTripId:s}),o=y();return[d,p(()=>{var a=e??P(o);return t||!a||r?.type!=null&&f.has(r.type)?(i&&i(),Promise.resolve([null,null])):n(a)},[t,r,i,n,o,e]),e=>h(e,o)]},R=(e,r,i)=>{var[a,p]=t.useState({fetching:!1,saved:!!i}),[,s]=l(T),[,d]=l(u);return[a,i?()=>i?(p({...a,fetching:!0}),d({itemId:i.id,tripId:r}).then(e=>{var r=e?.data?.tripsRemoveItem;return r?p({fetching:!1,saved:!1,result:{trip:r}}):p({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM",tripsError:void 0}}),a}).catch(()=>(p({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM"}}),a))):Promise.resolve(a):()=>(p({...a,fetching:!0}),s({tripId:r,referenceId:`${e.id}`,referenceType:e.type,allowDuplicates:!1}).then(e=>{var r=e?.data?.addItemToTrip?.trip,t=e?.data?.addItemToTrip?.errors?.[0]?.error;if(t||!r)return p({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:t||void 0}}),a;var i=e?.data?.addItemToTrip?.items?.[0];return i?p({fetching:!1,saved:!0,result:{trip:r,tripItem:i}}):p({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),a}).catch(()=>(p({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),a)))]};return[()=>{v=g,f=new Set(["savesItem","bundleSave","gaiTrip","publicTripBundle"]),e({getMostRecentlyAddedToTrip:P,useAutosave:E,useSave:v,useTripSaveToggle:R})},[e=>(t=e,i=e.useState,a=e.useMemo,p=e.useCallback),e=>(s=e.AddItemToTrip,d=e.TripsCopyTrip,n=e.TripsCopyTripItem,o=e.GetTripTitle,T=e.AddItemWithFullTrip,u=e.RemoveItemWithFullTrip),e=>(c=e.useClient,l=e.useMutation),e=>I=e.getItemByReference,e=>m=e.default,e=>y=e.useUserId]]},["o4yt4q","ag9b0s","mqwhqn","iyqcwg","9b9b10","52far5"]]);
