(this.$WP=this.$WP||[]).push(["iyqcwg",(e,t)=>{var o,r,i,n,a,s,p,l,c,u,d,m=e=>e.photo&&e.photo.photoSizes[e.photo.photoSizes.length-1]?e.photo.photoSizes[e.photo.photoSizes.length-1]:null,f=e=>[e.owner||e.userProfile,...(e.collaborators||[]).map(e=>e.user)].filter(Boolean),h=(e,t)=>f(e).some(e=>e.isMe||e.userId&&e.userId===t||e.id&&e.id===t),v=e=>e.owner?.isMe?"OWNER":e&&h(e)?"COLLABORATOR":"PUBLIC",T=(e,t,o,r)=>{var i=f(e);if(i=i.slice(0,t),o>0){var n=0;i=i.filter(e=>(n=e.displayName.length+n)<o)}return r&&(i=i.reverse()),i},y=(e,t)=>[...t||[]].sort((e,t)=>e.created>t.created?1:-1),P=e=>e?.owner?.isMe,g=e=>e.owner&&e.owner.isMe?"OWNER":h(e)?"COLLABORATOR":"VIEWER",w=(e,t)=>(e.items||[]).find(e=>{var o=e.reference&&e.reference.type&&e.reference.type.toLowerCase(),r=e.reference?.id,i=t.type.toLowerCase(),n=t.id.toString(),a="originalObject"in t&&t.originalObject?.type?.toLowerCase(),s="originalObject"in t&&t.originalObject?.id?.toString();return o===i&&r===n||o===a&&r===s}),I=(e,t)=>{var o=w(e,t);return o?o.id:null},_={locationinformation:"location",attractionproductinformation:"attractionProduct",forumpost:"post",tripitem:"savesItem",linkpost:"link",linkpost_linkpostv2:"link",photo:"photo",video:"video",review:"review",repost:"repost",trip:"bundleSave",tripnotes_tripnote:"note"},O={locationinformation:"LOCATION",attractionproductinformation:"ATTRACTIONPRODUCT",forumpost:"POST",tripitem:"SAVESITEM",linkpost:"LINK",photo:"PHOTO",video:"VIDEO",review:"REVIEW",repost:"REPOST",trip:"TRIPCONTENT"},b=e=>({statQuery:e}),S=e=>_[e.toLowerCase()],R=e=>O[e.toLowerCase()],L=["LocationInformation","AttractionProductInformation","ForumPost","LinkPost","LinkPost_LinkPostV2","Review","Photo","Video","Repost","Trip","TripNotes_TripNote"],k=e=>e.locationId??e.attractionProductId??e.postId??e.repostId??e.linkPostId??e.id??void 0,j=e=>{switch(e.__typename){case"AttractionProductInformation":case"LocationInformation":return[e];case"Photo":case"Review":return[e.location];case"Video":return e.orderedLocations;default:return[]}},F=(e,t)=>{if(!e)return null;var o=k(e),r=e.__typename?S(e.__typename):null;if(null!=o&&null!=r){if(L.includes(e.__typename))return{type:r,id:o};var i={id:e.reference.id,type:"attractionproduct"===e.reference.type?"attractionProduct":e.reference.type};if("TripItem"===e.__typename&&e.reference&&e.reference.id&&e.reference.type)return t&&"note"!==i.type?i:{type:r,id:o,originalObject:i}}return null},C=e=>({id:`${e.id}`,type:e.type}),A=({tripId:e,itemId:t,tab:o,showHotelPicksTooltip:r,filters:i})=>{var n=t?`?itemId=${t}`:"",a=o?`/Tab/${o}${i?`/${i.join("&")}`:""}`:"",s=r?"/showTooltip":"";return`/Trips/${e}${n}${a||s?`#${a}${s}`:""}`},E=e=>{var[,t,o]=e.split("/");return"Tab"!==t?null:Object.values(u).includes(o)?o:null},N=e=>"showTooltip"===e.split("/").slice(-1)[0],$=e=>{var[,t,o,...r]=e.split("/");if("Tab"===t&&o===u.ForYou){var i=r.filter(e=>!!e&&"showTooltip"!==e),n=i.length?i.flatMap(e=>e.split("&")):void 0;return n?.length?i:void 0}},V=e=>{var t=d[e.type];return t?{...e,query:t.statQuery,variables:{ids:[Number(e.id)]}}:null},z=e=>["LinkPost","Photo","Review","Video"].includes(e?.object?.repostedObject?.__typename),B=(e,t)=>{if("_blank"===t){var o=window.open("about:blank",t);return()=>{null!=o&&(o.location=e)}}return()=>{window.open(e,t)}};function M(e,t){return e.reduce((e,o)=>(t(o)?e[0].push(o):e[1].push(o),e),[[],[]])}var D=e=>{if(!("__typename"in e))return[];if("LinkPost_LinkPostV2"===e.__typename){var t=e.preview?.media??[];if(!t.length)return[];var[o,r]=M(t.reduce((e,t)=>t&&t.object?[...e,t]:e,[]).sort((e,t)=>t.id-e.id),e=>"LinkPreview_PhotoRefV2"===e.__typename);if(o.length)return o[0]?.object?.photoSizes??[];if(r.length)return[r[0].object]}if("LinkPost"===e.__typename){var i=e.preview&&e.preview.media||[];if(0===i.length)return[];var n=e=>("Photo"===e.__typename?e.photoId:e.previewId)??0,[a,s]=M(i.filter(Boolean).sort((e,t)=>n(t)-n(e)),e=>e?.__typename==="Photo");if(a.length)return a[0]?.photoSizes??[];if(s.length)return[s[0]]}return[]},U=(e,t)=>Math.round(Math.abs(e.getTime()-t.getTime())/864e5)+1;return[()=>{d=Object.freeze({location:b(o),attractionProduct:b(r),post:b(i),savesItem:b(n),link:b(a),review:b(s),photo:b(p),video:b(l),repost:b(c)}),e({buildPublicTripShareUrl:A,getCommentsForDisplay:y,getFiltersFromFragment:$,getItemByReference:w,getItemIdByReference:I,getPhotoSizesForLinkPost:D,getQueryReferenceTypeFromObjectType:R,getReferenceTypeFromObjectType:S,getShowHotelPicksTooltipFromFragment:N,getTripCoverPhoto:m,getTripPageTabFromFragment:E,getTripUsers:f,getTripUsersForDisplay:T,isOwner:P,isRepostSaveable:z,isTripUser:h,locationsForItem:j,objectStatisticQuery:V,toDurationInDays:U,toReference:C,toSavesObject:F,userRelation:g,userTypeFromTrip:v,windowOpener:B})},[e=>(o=e.LocationStatistics,r=e.AttractionStatistics,i=e.ForumStatistics,n=e.TripItemStatistics,a=e.LinkPostStatistics,s=e.ReviewStatistics,p=e.PhotoStatistics,l=e.VideoStatistics,c=e.RepostStatistics),e=>u=e.TRIP_PAGE_TAB_OPTIONS]]},["ag9b0s","3309mt"]]);
