(this.$WP=this.$WP||[]).push(["bt3bv2",(e,t)=>{var r,a,i,n,s,l,o,u,c,E,d,m,_,T,I,v,p,y,b,g,f,A,w,S,C,h,R,x,D,P,L,H,k,V,B,z,X,M,j,q,N,Z,O="test",K="EXIT",W="brazeInitialized",Y="brazeInterstitialsData",G="visible",U="USER",F=["Hotels","Hotel_Review","AttractionProductReview"],$="ExperiencesExitIntentInterstitial",Q="EXP_EXIT",J=["HotelsFusion"],ee="HotelsExitIntentInterstitial",et="HOTELS_EXIT",er=(e,t,r)=>{var a=e.get(t),i=new Date().getTime();return a&&a?.find(e=>e.key===r&&(!e.ttl||e.ttl>=i))||null},ea=(e,t,r)=>{var a=ei(),i=er(a,e,t)?.value;return i&&"object"==typeof i?i[r]:null},ei=()=>new Map(u.get(Y)),en=(e,t,r)=>{var a=e.get(t),i=new Date().getTime();return a=a?.filter(e=>e.key!==r.key&&(!e.ttl||e.ttl>=i))||[],r.ttl&&(r.ttl+=i),a.push(r),e.set(t,a),e},es=(e,t,r,a)=>{if(null!=e){var i=ei();en(i,e,{key:t,value:r,ttl:a}),u.set(Y,Array.from(i.entries()))}},el=(e,t,r,a)=>{if(null!=e){var i=ea(e,a,t);es(e,a,{[t]:null==i?1:i+1},r)}},eo=e=>{var t=H.getObjectValueFromStorage(e,G,U);return null==t?0:t},eu=e=>eo(e)+1,ec=(e,t=!1)=>{switch(e){case"AttractionProductReview":return"experiences_exit_interstitial_v1_1690405639";case"HotelsFusion":case"Hotel_Review":if(t)return"hotels_exit_interstitial__h_us_v1__1694445041";return"hotels_exit_interstitial__h_row_v1__1694445188";default:return""}},eE=(e,t=!1)=>{var{page:r}=c(),a=_(),{userAgentCategory:i}=m(),n=ec(r,"en-US"===a),s=v({experimentKeys:[n],skipImpression:t},e||!n||"DESKTOP"!==i);return s?s[n]:""},ed=()=>{var{page:e}=c(),t=J.includes(e),r=T(I.TARGETING),{userAgentCategory:a}=m();return k(t&&r&&"DESKTOP"===a,!0)===O},em=(e,t)=>{var[r,n]=a(!1);return i(()=>{var r;return t||(r=setTimeout(()=>n(!0),e)),()=>clearTimeout(r)},[e,t]),r},e_=()=>{var{page:e}=c(),t=F.includes(e),r=T(I.TARGETING),{userAgentCategory:a}=m(),i=V();return B(0,!1)&&(t&&r&&"DESKTOP"===a||i)},eT={error:"/HD6ArEBAtTwBI7ZVjta90qp4unZxfbHurUTBGj19rQQ0+FVYV8WhM5fZH0wzrq+",ok:"/HD6ArEBAtTwBI7ZVjta9/W82wQIR3jyvbLaRjmIOqY="},eI=(e,t)=>{M.set(e,t)},ev=e=>M.get(e),ep=()=>{var e=z(),{browser:r,os:a}=m(),i=d(),s=_(),l=E(),{params:o}=c(),T="detailId"in o?o.detailId:0,I="geoId"in o?o.geoId:0,v=X.useConstantIncrementCallback();return n(async({event:n,eventProperties:o})=>{if(u.get(W)&&e){var{logCustomEvent:c}=await t("tnit44");try{var E=ev(n);c(n,{...o,page:l,detailId:T,geoId:I,deviceType:i,locale:s,customEventData:E,isCustomEventDataPresent:!!E}),v(eT.ok)}catch(e){console.error(`[Braze] Problem occurred on: ${r.family} - ${r.majorVersion} | ${a.family} - ${a.majorVersion} | `,e),v(eT.error)}}},[e,l,T,I,i,r,a,s,v])},ey={interstitialMaxDisplay:-1,template:"",trackItemName:"",exitDelayTime:-1},eb=()=>{var{page:e}=c();switch(e){case"AttractionProductReview":return{interstitialMaxDisplay:3,template:Q,trackItemName:$,exitDelayTime:P};case"HotelsFusion":return{interstitialMaxDisplay:3,template:et,trackItemName:ee,exitDelayTime:L};default:return ey}},eg=()=>{var{params:e}=c(),t=E(),r=!!A(),a=f();return{trackImpression:n(({itemName:i,customData:n})=>{a({itemName:i,page:t,geoId:"geoId"in e&&e.geoId||null,locationId:"detailId"in e&&e.detailId||null,customData:JSON.stringify({...n,signedIn:r,isEligibility:!0})})},[a,e,t,r])}},ef=({dismiss:e=()=>{}})=>{var[t,r]=a(!1),[l,u]=a(!0),c=k(l),{interstitialMaxDisplay:E,template:d,trackItemName:m,exitDelayTime:_}=q(),T=j(),I=n(()=>{T({event:K,eventProperties:{abTestValue:c,displayCount:eu(d)}})},[d,c,T]),v=s(I),{trackImpression:p}=N(),y=n(()=>{var e=eu(d);c===O&&e<=E&&p({itemName:m,customData:{impressionCount:e,sessionCount:e}})},[d,E,m,c,p]),b=s(y),g=n(e=>{t&&(e.clientY<=0&&c?(I(),y()):e.clientY<=0&&!c&&u(!1))},[t,c,I,y]);return i(()=>{v.current!==I&&(v.current=I),b.current!==y&&(b.current=y)},[I,y]),i(()=>{!l&&c&&(v.current(),b.current())},[c,l]),i(()=>{var e=setTimeout(()=>r(!0),_);return()=>{e&&clearTimeout(e)}},[_]),o("mouseout",g),o("beforeunload",e),null},eA=()=>{var e=e=>r(ef,{dismiss:e}),t="interstitials-braze";return l({factory:({dismiss:t})=>e(t),eventTypes:[t],key:t,tier:700}),null},ew={__key:0xb28d0534b3ca,id:"b28d0534b3caa770",loc:{},definitions:[]},eS="braze_alias_call_1696520108",eC=()=>{var[e,n]=a(null),s=h(),l=!!(s.startsWith("hare")||s.includes("qa.tripadvisor-preview.com")),o=v({experimentKeys:[eS]}),[{data:c}]=R({query:ew,pause:o?.[eS]!=="test"});return i(()=>{var e;return(async()=>{var{initialize:r,automaticallyShowInAppMessages:a,openSession:i,destroy:s,getUser:o}=await t("tnit44"),E=r(l?"33cabfd1-22ad-4bb9-b839-923528e22192":"6e55efa5-e689-47c3-a55b-e6d7515a6c5d",{baseUrl:"sdk.iad-05.braze.com",sessionTimeoutInSeconds:60,minimumIntervalBetweenTriggerActionsInSeconds:1,enableLogging:l,allowUserSuppliedJavascript:!0,manageServiceWorkerExternally:!0,noCookies:!0,inAppMessageZIndex:10104,doNotLoadFontAwesome:!0});if(E){a(),i(),e=s;var d=c?.data?.hashedPersistentCookieSHA256;if(d){var m=o();m?.addAlias(d,"ta_persistent_cookie_sha256")}u.set(W,!0,x)}else u.set(W,!1,x);n(E)})(),()=>{e&&e()}},[c,l]),r(w,{component:S.braze,status:e?C.ok:C.missing,enabled:null!==e})},eh=()=>z()?r(g,{children:r(eC,{})}):null;return[()=>{D=12*(30*(x=864e5)),P=15e3,L=1e4,H={getObjectValueFromStorage:ea,getBrazeStorageData:ei,saveValueToLocalStorage:es,saveDisplayCountToBrazeStorage:el},k=eE,V=ed,B=em,z=e_,X=new p({metricName:"/HD6ArEBAtTwBI7ZVjta93C0lsh0r5m7+1h2uMR+Ctj6S7rKi5+tmJVNyp6fjPiaq5rr6c5rsp+XGnGmyrZ6y64ZVL67MHPVqEacrZP0wZY=",version:0,additionalLabels:["/HD6ArEBAtTwBI7ZVjta98Sr44QR3Z1Lmq5fKuJGI7cdKriEzyXX7YlewxVwwfzY"],labelHooks:[y,b]}),M=new Map,j=ep,q=eb,N=eg,Z=eA,e({BRAZE_EXIT_EVENT_KEY:K,BRAZE_EXIT_EVENT_TEST_BUCKET:O,Braze:eh,EXP_EXIT_TEMPLATE:Q,EXP_EXIT_TRACK_ITEM_NAME:$,HOTELS_EXIT_TEMPLATE:et,HOTELS_EXIT_TRACK_ITEM_NAME:ee,HOTEL_REVIEW_EXIT_TEMPLATE:"HOTEL_REVIEW_EXIT",LOCAL_STORAGE_TTL_01_YEAR:D,PER_USER_DISPLAY:U,VISIBLE:G,brazeStorage:H,default:Z,getInterstitialsCustomEventData:ev,getStoredDisplayCount:eo,setInterstitialsCustomEventData:eI,useBrazeExitIntentTest:k,useBrazeLogCustomEventCallback:j})},[e=>r=e.jsx,e=>(a=e.useState,i=e.useEffect,n=e.useCallback,s=e.useRef),e=>l=e.usePopupHierarchyRender,e=>o=e.useWindow,e=>u=e.default,e=>c=e.useRoute,e=>E=e.default,e=>d=e.useViewportCategory,e=>m=e.useUserAgent,e=>_=e.useLocale,e=>(T=e.useConsent,I=e.CategoriesEnum),e=>v=e.default,e=>(p=e.Counter,y=e.useSourceLabel,b=e.useWebApplicationLabel,g=e.ErrorBoundary),e=>f=e.default,e=>A=e.useUserId,e=>(w=e.StatusCounter,S=e.Component,C=e.Status),e=>h=e.useDomainName,e=>R=e.useQuery]]},["21h32l","o4yt4q","xo1is3","ltllz9","9b9b10","fgwvq1","eqoaya","ys6v1o","nnprhg","7thqz4","973cci","gugp1d","83pm0d","xg719z","52far5","6nmgrj","qlcuu5","mqwhqn"]]);
